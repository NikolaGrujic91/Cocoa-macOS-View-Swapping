<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>

<h1>Cocoa - Swap Views</h1>

<p>
    This post is part of Cocoa UI examples series.
    </br></br>
    It covers the implementation of swapping NSView objects with animated transition.
    </br></br>
    Example is built on macOS Catalina and Xcode 11.3.
    </br></br>
    <a>GitHub | Repository name</a>
</p>

<h2>Add controls</h2>
<p>
    In the Interface Builder placeholder Custom View has to be added to MainMenu.xib window.
    Add two additional Custom Views that are not part of the main window.
    <br><br>
    It should look like this in the end.
    <br><br>
    <video width="640" height="480" controls>
        <source src="App.mov" type="video/mp4">
        Your browser does not support the video tag.
    </video> 
</p>

<h2>Setting up NSView animated transition</h2>
<p>
    It is neccessary to set the animated transition for the placeholder NSView object.
    <figure>
        <figcaption>Set up Outline View</figcaption>
        <pre class="prettyprint">
          <code>
            - (void)setTransition
            {
                [_mainView setWantsLayer:YES];
                 
                CATransition *transition = [CATransition animation];
                [transition setDuration:1.0];
                [transition setType:kCATransitionPush];
                [transition setSubtype:kCATransitionFromRight];
                
                NSDictionary *dictionary = [NSDictionary dictionaryWithObject:transition forKey:@"subviews"];
                [_mainView setAnimations:dictionary];
            }
          </code>
        </pre>
      </figure>
</p>

<h2>AppDelegate class complete implementation</h2>
<p>
  <figure>
      <figcaption>AppDelegate.h</figcaption>
      <pre class="prettyprint">
        <code>
            #import <Cocoa/Cocoa.h>

            @interface AppDelegate : NSObject <NSApplicationDelegate>
            {
                NSString *currentView;
            }
            
            @property (weak) IBOutlet NSWindow *window;
            @property (retain, nonatomic) IBOutlet NSButton *nextButton;
            @property (retain, nonatomic) IBOutlet NSView *mainView;
            @property (retain, nonatomic) IBOutlet NSView *view1;
            @property (retain, nonatomic) IBOutlet NSView *view2;
            
            - (void)setTransition;
            
            - (IBAction)nextClicked:(id)sender;
            
            @end
                     
        </code>
      </pre>
    </figure>

    <figure>
      <figcaption>AppDelegate.m</figcaption>
      <pre class="prettyprint">
        <code>
            #import "AppDelegate.h"
            #import <QuartzCore/QuartzCore.h>

            @implementation AppDelegate

            - (void)applicationDidFinishLaunching:(NSNotification *)notification
            {
                currentView = @"view1";
                [_mainView addSubview:_view1];
                [self setTransition];
            }

            - (void)setTransition
            {
                [_mainView setWantsLayer:YES];
                
                CATransition *transition = [CATransition animation];
                [transition setDuration:1.0];
                [transition setType:kCATransitionPush];
                [transition setSubtype:kCATransitionFromRight];
                
                NSDictionary *dictionary = [NSDictionary dictionaryWithObject:transition forKey:@"subviews"];
                [_mainView setAnimations:dictionary];
            }

            #pragma mark Action methods

            - (IBAction)nextClicked:(id)sender
            {
                if ([currentView isEqualToString:@"view1"] == YES)
                {
                    [[_mainView animator] replaceSubview:_view1 with:_view2];
                    currentView = @"view2";
                }
                else
                {
                    [[_mainView animator] replaceSubview:_view2 with:_view1];
                    currentView = @"view1";
                }
            }

            @end
        </code>
      </pre>
    </figure>
</p>













